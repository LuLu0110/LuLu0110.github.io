<!DOCTYPE html><html lang="en"><head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WrenchJS 神策 SDK 工具库 -  ry.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async="" defer="" src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
             
                <a href="index.html">
                    <h1 class="navbar-item">WrenchJS 神策 SDK 工具库</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a href="index.html" class="link">
                    Documentation
                </a>
                
                 
                    
                        <a class="link user-link " href="https://github.com/sensorsdata/wrench">
                            Github
                        </a>
                    
                        <a class="link user-link " href="https://www.npmjs.com/package/wrenchjs">
                            Npm
                        </a>
                    
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div class="sidebar " id="sidebarNav">
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Global</h3><ul><li><a href="global.html#getSafeHostname">getSafeHostname</a></li></ul></div><div class="category"><h2>Array</h2><h3>Global</h3><ul><li><a href="global.html#each">each</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#indexOf">indexOf</a></li><li><a href="global.html#map">map</a></li><li><a href="global.html#toArray">toArray</a></li><li><a href="global.html#unique">unique</a></li><li><a href="global.html#values">values</a></li></ul></div><div class="category"><h2>Bom</h2><h3>Modules</h3><ul><li><a href="module-cookie.html">cookie</a></li><li><a href="module-localStorage.html">localStorage</a></li><li><a href="module-sessionStorage.html">sessionStorage</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ajax">ajax</a></li><li><a href="global.html#decodeURI">decodeURI</a></li><li><a href="global.html#decodeURIComponent">decodeURIComponent</a></li><li><a href="global.html#getCookieTopLevelDomain">getCookieTopLevelDomain</a></li><li><a href="global.html#getHostname">getHostname</a></li><li><a href="global.html#getIOSVersion">getIOSVersion</a></li><li><a href="global.html#getQueryParam">getQueryParam</a></li><li><a href="global.html#getQueryParamsFromUrl">getQueryParamsFromUrl</a></li><li><a href="global.html#getScreenOrientation">getScreenOrientation</a></li><li><a href="global.html#getUA">getUA</a></li><li><a href="global.html#getURL">getURL</a></li><li><a href="global.html#getURLPath">getURLPath</a></li><li><a href="global.html#getURLSearchParams">getURLSearchParams</a></li><li><a href="global.html#isIOS">isIOS</a></li><li><a href="global.html#isSupportBeaconSend">isSupportBeaconSend</a></li><li><a href="global.html#isSupportCors">isSupportCors</a></li><li><a href="global.html#jsonp">jsonp</a></li><li><a href="global.html#mediaQueriesSupported">mediaQueriesSupported</a></li><li><a href="global.html#URL">URL</a></li><li><a href="global.html#urlParse">urlParse</a></li><li><a href="global.html#xhr">xhr</a></li></ul></div><div class="category"><h2>Dom</h2><h3>Global</h3><ul><li><a href="global.html#getDomBySelector">getDomBySelector</a></li><li><a href="global.html#getElementContent">getElementContent</a></li><li><a href="global.html#hasAttribute">hasAttribute</a></li><li><a href="global.html#hasAttributes">hasAttributes</a></li><li><a href="global.html#loadScript">loadScript</a></li><li><a href="global.html#ry">ry</a></li><li><a href="global.html#setCssStyle">setCssStyle</a></li></ul></div><div class="category"><h2>Encoding</h2><h3>Modules</h3><ul><li><a href="module-urlSafeBase64.html">urlSafeBase64</a></li></ul><h3>Global</h3><ul><li><a href="global.html#base64Decode">base64Decode</a></li><li><a href="global.html#base64Encode">base64Encode</a></li><li><a href="global.html#dfmapping">dfmapping</a></li><li><a href="global.html#formatJsonString">formatJsonString</a></li><li><a href="global.html#hashCode">hashCode</a></li><li><a href="global.html#hashCode53">hashCode53</a></li><li><a href="global.html#rot13defs">rot13defs</a></li><li><a href="global.html#rot13obfs">rot13obfs</a></li><li><a href="global.html#safeJSONParse">safeJSONParse</a></li><li><a href="global.html#strToUnicode">strToUnicode</a></li></ul></div><div class="category"><h2>Event</h2><h3>Classes</h3><ul><li><a href="EventEmitter.html">EventEmitter</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addEvent">addEvent</a></li><li><a href="global.html#addHashEvent">addHashEvent</a></li><li><a href="global.html#bindReady">bindReady</a></li><li><a href="global.html#listenPageState">listenPageState</a></li></ul></div><div class="category"><h2>Math</h2><h3>Global</h3><ul><li><a href="global.html#getRandom">getRandom</a></li><li><a href="global.html#getRandomBasic">getRandomBasic</a></li></ul></div><div class="category"><h2>String</h2><h3>Global</h3><ul><li><a href="global.html#trim">trim</a></li></ul></div><div class="category"><h2>Util</h2><h3>Modules</h3><ul><li><a href="module-logger.html">logger</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ConcurrentStorage">ConcurrentStorage</a></li><li><a href="global.html#coverExtend">coverExtend</a></li><li><a href="global.html#encodeDates">encodeDates</a></li><li><a href="global.html#extend">extend</a></li><li><a href="global.html#extend2Lev">extend2Lev</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#inherit">inherit</a></li><li><a href="global.html#isArguments">isArguments</a></li><li><a href="global.html#isArray">isArray</a></li><li><a href="global.html#isBoolean">isBoolean</a></li><li><a href="global.html#isDate">isDate</a></li><li><a href="global.html#isElement">isElement</a></li><li><a href="global.html#isEmptyObject">isEmptyObject</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#isHttpUrl">isHttpUrl</a></li><li><a href="global.html#isJSONString">isJSONString</a></li><li><a href="global.html#isNumber">isNumber</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#isString">isString</a></li><li><a href="global.html#isUndefined">isUndefined</a></li><li><a href="global.html#now">now</a></li><li><a href="global.html#searchObjDate">searchObjDate</a></li><li><a href="global.html#throttle">throttle</a></li><li><a href="global.html#UUID">UUID</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>ry.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import isElement from './isElement';
import isUndefined from './isUndefined';
import isArray from './isArray';

/**
 * @typedef {Object} DomElementInfo 包含了 Dom 信息获取和设置方法的对象
 * @property {Function} addClass &lt;strong&gt;addClass (className:String)-&gt;void&lt;/strong&gt;&lt;br&gt;为 Dom 元素添加样式类名
 * @property {Function} removeClass &lt;strong&gt;removeClass(className:String)-&gt;void&lt;/strong&gt;&lt;br&gt;为 Dom 元素删除样式类名
 * @property {Function} hasClass &lt;strong&gt;hasClass(className:String)-&gt;Boolean &lt;/strong&gt;&lt;br&gt;检测 Dom 元素是否具有指定样式类名
 * @property {Function} attr &lt;strong&gt;attr(key:String,?value:String)-&gt;String|null &lt;/strong&gt;&lt;br&gt;获取和设置 Dom 元素属性。当只传 key 不传 value 时，方法获取元素中名为 key 的属性值。当传了 key 和 value 时，方法为 dom 元素设置名为 key 值为 value 的属性。
 * @property {Function} offset &lt;strong&gt;offset()-&gt;{left:Number,top:Number} &lt;/strong&gt;&lt;br&gt;获取 Dom 元素相对浏览器窗口左上角的偏移位置
 * @property {Function} getSize &lt;strong&gt;getSize()-&gt;{width:NUmber, height:Number} &lt;/strong&gt;&lt;br&gt;获取 Dom 元素的宽高
 * @property {Function} getStyle &lt;strong&gt;getStyle(property:String)-&gt;String &lt;/strong&gt;&lt;br&gt;获取 Dom 元素的指定样式的值，如: getStyle('width')
 */

/**
 * @category Dom
 * @param {Element} dom 传入的 dom 元素
 * @returns {DomElementInfo} 元素信息对象，用于获取元素信息
 * @function ry
 * @example
 * var a =  document.getElementById('banner');
 * var b =ry(a);
 * b.addClass('banner-style');
 * // =&gt; &lt;h1 id='banner' class='banner-style'&gt; hello world &lt;/h1&gt;
 */
export default function ry(dom) {
  return new DomElementInfo(dom);
}

var DomElementInfo = function (dom) {
  this.ele = dom;
};

var siblings = function (n, elem) {
  var matched = [];

  for (; n; n = n.nextSibling) {
    if (n.nodeType === 1 &amp;&amp; n !== elem) {
      matched.push(n);
    }
  }

  return matched;
};

DomElementInfo.prototype = {
  addClass: function (para) {
    var classes = ' ' + this.ele.className + ' ';
    if (classes.indexOf(' ' + para + ' ') === -1) {
      this.ele.className = this.ele.className + (this.ele.className === '' ? '' : ' ') + para;
    }
    return this;
  },
  removeClass: function (para) {
    var classes = ' ' + this.ele.className + ' ';
    if (classes.indexOf(' ' + para + ' ') !== -1) {
      this.ele.className = classes.replace(' ' + para + ' ', ' ').slice(1, -1);
    }
    return this;
  },
  hasClass: function (para) {
    var classes = ' ' + this.ele.className + ' ';
    if (classes.indexOf(' ' + para + ' ') !== -1) {
      return true;
    } else {
      return false;
    }
  },
  attr: function (key, value) {
    if (typeof key === 'string' &amp;&amp; isUndefined(value)) {
      return this.ele.getAttribute(key);
    }
    if (typeof key === 'string') {
      value = String(value);
      this.ele.setAttribute(key, value);
    }
    return this;
  },
  offset: function () {
    try {
      var rect = this.ele.getBoundingClientRect();
      var doc = this.ele.ownerDocument;
      var docElem = doc.documentElement;
      return {
        top: rect.top + window.pageYOffset - docElem.clientTop,
        left: rect.left + window.pageXOffset - docElem.clientLeft
      };
    } catch (e) {
      return {
        top: 0,
        left: 0
      };
    }
  },
  getSize: function () {
    if (!window.getComputedStyle) {
      return { width: this.ele.offsetWidth, height: this.ele.offsetHeight };
    }
    try {
      var bounds = this.ele.getBoundingClientRect();
      return { width: bounds.width, height: bounds.height };
    } catch (e) {
      return { width: 0, height: 0 };
    }
  },
  getStyle: function (value) {
    if (this.ele.currentStyle) {
      return this.ele.currentStyle[value];
    } else {
      return this.ele.ownerDocument.defaultView.getComputedStyle(this.ele, null).getPropertyValue(value);
    }
  },
  wrap: function (elementTagName) {
    var ele = document.createElement(elementTagName);
    this.ele.parentNode.insertBefore(ele, this.ele);
    ele.appendChild(this.ele);
    return ry(ele);
  },
  getCssStyle: function (prop) {
    var result = this.ele.style.getPropertyValue(prop);
    if (result) {
      return result;
    }
    var rules = null;
    if (typeof window.getMatchedCSSRules === 'function') {
      rules = window.getMatchedCSSRules(this.ele);
    }
    if (!rules || !isArray(rules)) {
      return null;
    }
    for (var i = rules.length - 1; i &gt;= 0; i--) {
      var r = rules[i];
      result = r.style.getPropertyValue(prop);
      if (result) {
        return result;
      }
    }
  },
  sibling: function (cur, dir) {
    //eslint-disable-next-line
    while ((cur = cur[dir]) &amp;&amp; cur.nodeType !== 1) { }
    return cur;
  },
  next: function () {
    return this.sibling(this.ele, 'nextSibling');
  },
  prev: function () {
    return this.sibling(this.ele, 'previousSibling');
  },
  siblings: function () {
    return siblings((this.ele.parentNode || {}).firstChild, this.ele);
  },
  children: function () {
    return siblings(this.ele.firstChild);
  },
  parent: function () {
    var parent = this.ele.parentNode;
    parent = parent &amp;&amp; parent.nodeType !== 11 ? parent : null;
    return ry(parent);
  },
  // 兼容原生不支持 previousElementSibling 的旧版浏览器
  previousElementSibling: function () {
    var el = this.ele;
    if ('previousElementSibling' in document.documentElement) {
      return ry(el.previousElementSibling);
    } else {
      while ((el = el.previousSibling)) {
        if (el.nodeType === 1) {
          return ry(el);
        }
      }
      return ry(null);
    }
  },
  // 得到和当前元素相同类型的同级元素
  getSameTypeSiblings: function () {
    var element = this.ele;
    var parentNode = element.parentNode;
    var tagName = element.tagName.toLowerCase();
    var arr = [];
    for (var i = 0; i &lt; parentNode.children.length; i++) {
      var child = parentNode.children[i];
      if (child.nodeType === 1 &amp;&amp; child.tagName.toLowerCase() === tagName) {
        arr.push(parentNode.children[i]);
      }
    }
    return arr;
  },
  //获取元素 path
  getParents: function () {
    try {
      var element = this.ele;
      if (!isElement(element)) {
        return [];
      }
      var pathArr = [element];
      if (element === null || element.parentElement === null) {
        return [];
      }
      while (element.parentElement !== null) {
        element = element.parentElement;
        pathArr.push(element);
      }
      return pathArr;
    } catch (err) {
      return [];
    }
  }
};
</code></pre>
        </article>
    </section>




            </div>
            
            
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>




</body></html>